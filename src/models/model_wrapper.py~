from models.unet import UNetModel
from models.segnet import SegNetModel
from models.segnet_nopadding import SegNetModel_np
from models.segnet_dropout import SegNetModel_dropout
from models.segnet_nopadding_v2 import SegNetModel_np_v2

import e3_tools.log.logger as modulelogger
logger = modulelogger.get_logger(__name__, use_color=True, level=modulelogger.logging.INFO)

def get_wrapper(options, **kwargs):
    MODEL_NAMES = {"UNet": UNetModel, "SegNet": SegNetModel,
                   "SegNet_np":  SegNetModel_np, "SegNet_dropout": SegNetModel_dropout,
                   "SegNet_np_v2": SegNetModel_np_v2}
    assert options['model']['name'] in MODEL_NAMES, 'Model %s non existing' %options['model']['name']
    return MODEL_NAMES[options['model']['name']](options, **kwargs)
